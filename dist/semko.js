// Knockout JavaScript library v1.2.1
// (c) Steven Sanderson - http://knockoutjs.com/
// License: MIT (http://www.opensource.org/licenses/mit-license.php)

(function(window,undefined){
var ko=window.ko={};ko.exportSymbol=function(a,c){for(var d=a.split("."),b=window,e=0;e<d.length-1;e++)b=b[d[e]];b[d[d.length-1]]=c};ko.exportProperty=function(a,c,d){a[c]=d};
ko.utils=new function(){function a(a,b){if("INPUT"!=a.tagName||!a.type||"click"!=b.toLowerCase())return!1;var d=a.type.toLowerCase();return"checkbox"==d||"radio"==d}var c=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,d=/MSIE 6/i.test(navigator.userAgent),b=/MSIE 7/i.test(navigator.userAgent),e={},f={},h=/Firefox\/2/i.test(navigator.userAgent)?"KeyboardEvent":"UIEvents";e[h]=["keyup","keydown","keypress"];e.MouseEvents="click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave".split(",");
for(var i in e)if(h=e[i],h.length)for(var g=0,j=h.length;g<j;g++)f[h[g]]=i;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(a,b){for(var d=0,c=a.length;d<c;d++)b(a[d])},arrayIndexOf:function(a,b){if("function"==typeof a.indexOf)return a.indexOf(b);for(var d=0,c=a.length;d<c;d++)if(a[d]===b)return d;return-1},arrayFirst:function(a,b,d){for(var c=0,e=a.length;c<e;c++)if(b.call(d,a[c]))return a[c];return null},arrayRemoveItem:function(a,
b){var d=ko.utils.arrayIndexOf(a,b);0<=d&&a.splice(d,1)},arrayGetDistinctValues:function(a){for(var a=a||[],b=[],d=0,c=a.length;d<c;d++)0>ko.utils.arrayIndexOf(b,a[d])&&b.push(a[d]);return b},arrayMap:function(a,b){for(var a=a||[],d=[],c=0,e=a.length;c<e;c++)d.push(b(a[c]));return d},arrayFilter:function(a,b){for(var a=a||[],d=[],c=0,e=a.length;c<e;c++)b(a[c])&&d.push(a[c]);return d},arrayPushAll:function(a,b){for(var d=0,c=b.length;d<c;d++)a.push(b[d])},emptyDomNode:function(a){for(;a.firstChild;)ko.removeNode(a.firstChild)},
setDomNodeChildren:function(a,b){ko.utils.emptyDomNode(a);b&&ko.utils.arrayForEach(b,function(b){a.appendChild(b)})},replaceDomNodes:function(a,b){var d=a.nodeType?[a]:a;if(0<d.length){for(var c=d[0],e=c.parentNode,g=0,f=b.length;g<f;g++)e.insertBefore(b[g],c);g=0;for(f=d.length;g<f;g++)ko.removeNode(d[g])}},setOptionNodeSelectionState:function(a,b){0<=navigator.userAgent.indexOf("MSIE 6")?a.setAttribute("selected",b):a.selected=b},getElementsHavingAttribute:function(a,b){if(!a||1!=a.nodeType)return[];
var d=[];null!==a.getAttribute(b)&&d.push(a);for(var c=a.getElementsByTagName("*"),e=0,g=c.length;e<g;e++)null!==c[e].getAttribute(b)&&d.push(c[e]);return d},stringTrim:function(a){return(a||"").replace(c,"")},stringTokenize:function(a,b){for(var d=[],c=(a||"").split(b),e=0,g=c.length;e<g;e++){var f=ko.utils.stringTrim(c[e]);""!==f&&d.push(f)}return d},stringStartsWith:function(a,b){a=a||"";return b.length>a.length?!1:a.substring(0,b.length)===b},evalWithinScope:function(a,b,d){if(void 0===b)return(new Function("return "+
a))();b.skonode=d;return(new Function("__SKO__sc","with(__SKO__sc){ var innerNode=skonode; return ("+a+") }"))(b)},domNodeIsContainedBy:function(a,b){if(b.compareDocumentPosition)return 16==(b.compareDocumentPosition(a)&16);for(;null!=a;){if(a==b)return!0;a=a.parentNode}return!1},domNodeIsAttachedToDocument:function(a){return ko.utils.domNodeIsContainedBy(a,document)},registerEventHandler:function(b,d,c){if("undefined"!=typeof jQuery){if(a(b,d))var e=c,c=function(a,b){var d=this.checked;b&&(this.checked=
!0!==b.checkedStateBeforeEvent);e.call(this,a);this.checked=d};jQuery(b).bind(d,c)}else if("function"==typeof b.addEventListener)b.addEventListener(d,c,!1);else if("undefined"!=typeof b.attachEvent)b.attachEvent("on"+d,function(a){c.call(b,a)});else throw Error("Browser doesn't support addEventListener or attachEvent");},triggerEvent:function(b,d){if(!b||!b.nodeType)throw Error("element must be a DOM node when calling triggerEvent");if("undefined"!=typeof jQuery){var c=[];a(b,d)&&c.push({checkedStateBeforeEvent:b.checked});
jQuery(b).trigger(d,c)}else if("function"==typeof document.createEvent)if("function"==typeof b.dispatchEvent)c=document.createEvent(f[d]||"HTMLEvents"),c.initEvent(d,!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,b),b.dispatchEvent(c);else throw Error("The supplied element doesn't support dispatchEvent");else if("undefined"!=typeof b.fireEvent){if("click"==d&&"INPUT"==b.tagName&&("checkbox"==b.type.toLowerCase()||"radio"==b.type.toLowerCase()))b.checked=!0!==b.checked;b.fireEvent("on"+d)}else throw Error("Browser doesn't support triggering events");
},unwrapObservable:function(a){return ko.isObservable(a)?a():a},domNodeHasCssClass:function(a,b){var d=(a.className||"").split(/\s+/);return 0<=ko.utils.arrayIndexOf(d,b)},toggleDomNodeCssClass:function(a,b,d){var c=ko.utils.domNodeHasCssClass(a,b);if(d&&!c)a.className=(a.className||"")+" "+b;else if(c&&!d){for(var d=(a.className||"").split(/\s+/),c="",e=0;e<d.length;e++)d[e]!=b&&(c+=d[e]+" ");a.className=ko.utils.stringTrim(c)}},range:function(a,b){for(var a=ko.utils.unwrapObservable(a),b=ko.utils.unwrapObservable(b),
d=[],c=a;c<=b;c++)d.push(c);return d},makeArray:function(a){for(var b=[],d=0,c=a.length;d<c;d++)b.push(a[d]);return b},isIe6:d,isIe7:b,getFormFields:function(a,b){for(var d=ko.utils.makeArray(a.getElementsByTagName("INPUT")).concat(ko.utils.makeArray(a.getElementsByTagName("TEXTAREA"))),c="string"==typeof b?function(a){return a.name===b}:function(a){return b.test(a.name)},e=[],g=d.length-1;0<=g;g--)c(d[g])&&e.push(d[g]);return e},parseJson:function(a){return"string"==typeof a&&(a=ko.utils.stringTrim(a))?
window.JSON&&window.JSON.parse?window.JSON.parse(a):(new Function("return "+a))():null},stringifyJson:function(a){if("undefined"==typeof JSON||"undefined"==typeof JSON.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return JSON.stringify(ko.utils.unwrapObservable(a))},postJson:function(a,b,d){var d=d||{},c=d.params||{},e=
d.includeFields||this.fieldsIncludedWithJsonPost,g=a;if("object"==typeof a&&"FORM"==a.tagName)for(var g=a.action,f=e.length-1;0<=f;f--)for(var i=ko.utils.getFormFields(a,e[f]),h=i.length-1;0<=h;h--)c[i[h].name]=i[h].value;var b=ko.utils.unwrapObservable(b),j=document.createElement("FORM");j.style.display="none";j.action=g;j.method="post";for(var q in b)a=document.createElement("INPUT"),a.name=q,a.value=ko.utils.stringifyJson(ko.utils.unwrapObservable(b[q])),j.appendChild(a);for(q in c)a=document.createElement("INPUT"),
a.name=q,a.value=c[q],j.appendChild(a);document.body.appendChild(j);d.submitter?d.submitter(j):j.submit();setTimeout(function(){j.parentNode.removeChild(j)},0)}}};ko.exportSymbol("ko.utils",ko.utils);ko.exportSymbol("ko.utils.arrayForEach",ko.utils.arrayForEach);ko.exportSymbol("ko.utils.arrayFirst",ko.utils.arrayFirst);ko.exportSymbol("ko.utils.arrayFilter",ko.utils.arrayFilter);ko.exportSymbol("ko.utils.arrayGetDistinctValues",ko.utils.arrayGetDistinctValues);
ko.exportSymbol("ko.utils.arrayIndexOf",ko.utils.arrayIndexOf);ko.exportSymbol("ko.utils.arrayMap",ko.utils.arrayMap);ko.exportSymbol("ko.utils.arrayPushAll",ko.utils.arrayPushAll);ko.exportSymbol("ko.utils.arrayRemoveItem",ko.utils.arrayRemoveItem);ko.exportSymbol("ko.utils.fieldsIncludedWithJsonPost",ko.utils.fieldsIncludedWithJsonPost);ko.exportSymbol("ko.utils.getElementsHavingAttribute",ko.utils.getElementsHavingAttribute);ko.exportSymbol("ko.utils.getFormFields",ko.utils.getFormFields);
ko.exportSymbol("ko.utils.postJson",ko.utils.postJson);ko.exportSymbol("ko.utils.parseJson",ko.utils.parseJson);ko.exportSymbol("ko.utils.registerEventHandler",ko.utils.registerEventHandler);ko.exportSymbol("ko.utils.stringifyJson",ko.utils.stringifyJson);ko.exportSymbol("ko.utils.range",ko.utils.range);ko.exportSymbol("ko.utils.toggleDomNodeCssClass",ko.utils.toggleDomNodeCssClass);ko.exportSymbol("ko.utils.triggerEvent",ko.utils.triggerEvent);ko.exportSymbol("ko.utils.unwrapObservable",ko.utils.unwrapObservable);
Function.prototype.bind||(Function.prototype.bind=function(a){var c=this,d=Array.prototype.slice.call(arguments),a=d.shift();return function(){return c.apply(a,d.concat(Array.prototype.slice.call(arguments)))}});
ko.utils.domData=new function(){var a=0,c="__ko__"+(new Date).getTime(),d={};return{get:function(a,d){var c=ko.utils.domData.getAll(a,!1);return void 0===c?void 0:c[d]},set:function(a,d,c){void 0===c&&void 0===ko.utils.domData.getAll(a,!1)||(ko.utils.domData.getAll(a,!0)[d]=c)},getAll:function(b,e){var f=b[c];if(!f){if(!e)return;f=b[c]="ko"+a++;d[f]={}}return d[f]},clear:function(a){var e=a[c];e&&(delete d[e],a[c]=null)}}};
ko.utils.domNodeDisposal=new function(){function a(a,c){var f=ko.utils.domData.get(a,d);void 0===f&&c&&(f=[],ko.utils.domData.set(a,d,f));return f}function c(b){sko.cleanNode(b);var d=a(b,!1);if(d)for(var d=d.slice(0),c=0;c<d.length;c++)d[c](b);ko.utils.domData.clear(b);"function"==typeof jQuery&&"function"==typeof jQuery.cleanData&&jQuery.cleanData([b])}var d="__ko_domNodeDisposal__"+(new Date).getTime();return{addDisposeCallback:function(b,d){if("function"!=typeof d)throw Error("Callback must be a function");
a(b,!0).push(d)},removeDisposeCallback:function(b,c){var f=a(b,!1);f&&(ko.utils.arrayRemoveItem(f,c),0==f.length&&ko.utils.domData.set(b,d,void 0))},cleanNode:function(a){if(!(1!=a.nodeType&&9!=a.nodeType)){c(a);var d=[];ko.utils.arrayPushAll(d,a.getElementsByTagName("*"));for(var a=0,f=d.length;a<f;a++)c(d[a])}},removeNode:function(a){ko.cleanNode(a);a.parentNode&&a.parentNode.removeChild(a)}}};ko.cleanNode=ko.utils.domNodeDisposal.cleanNode;ko.removeNode=ko.utils.domNodeDisposal.removeNode;
ko.exportSymbol("ko.cleanNode",ko.cleanNode);ko.exportSymbol("ko.removeNode",ko.removeNode);ko.exportSymbol("ko.utils.domNodeDisposal",ko.utils.domNodeDisposal);ko.exportSymbol("ko.utils.domNodeDisposal.addDisposeCallback",ko.utils.domNodeDisposal.addDisposeCallback);ko.exportSymbol("ko.utils.domNodeDisposal.removeDisposeCallback",ko.utils.domNodeDisposal.removeDisposeCallback);
(function(){ko.utils.parseHtmlFragment=function(a){if("undefined"!=typeof jQuery)a=jQuery.clean([a]);else{var c=ko.utils.stringTrim(a).toLowerCase(),d=document.createElement("div"),c=c.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!c.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!c.indexOf("<td")||!c.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""];for(d.innerHTML=c[1]+a+c[2];c[0]--;)d=d.lastChild;a=ko.utils.makeArray(d.childNodes)}return a};ko.utils.setHtml=
function(a,c){ko.utils.emptyDomNode(a);if(null!==c&&void 0!==c)if("string"!=typeof c&&(c=c.toString()),"undefined"!=typeof jQuery)try{jQuery(a).html(c)}catch(d){jQuery(a).html(c.replace("<","&lt;").replace(">","&gt;"))}else for(var b=ko.utils.parseHtmlFragment(c),e=0;e<b.length;e++)a.appendChild(b[e])}})();
ko.memoization=function(){function a(){return(4294967296*(1+Math.random())|0).toString(16).substring(1)}function c(a,d){if(a)if(8==a.nodeType){var f=ko.memoization.parseMemoText(a.nodeValue);null!=f&&d.push({domNode:a,memoId:f})}else if(1==a.nodeType)for(var f=0,h=a.childNodes,i=h.length;f<i;f++)c(h[f],d)}var d={};return{memoize:function(b){if("function"!=typeof b)throw Error("You can only pass a function to ko.memoization.memoize()");var c=a()+a();d[c]=b;return"<\!--[ko_memo:"+c+"]--\>"},unmemoize:function(a,
c){var f=d[a];if(void 0===f)throw Error("Couldn't find any memo with ID "+a+". Perhaps it's already been unmemoized.");try{return f.apply(null,c||[]),!0}finally{delete d[a]}},unmemoizeDomNodeAndDescendants:function(a,d){var f=[];c(a,f);for(var h=0,i=f.length;h<i;h++){var g=f[h].domNode,j=[g];d&&ko.utils.arrayPushAll(j,d);var k=d[0];sko.traceResources(a,k,function(){sko.traceRelations(a,k,function(){ko.memoization.unmemoize(f[h].memoId,j);g.nodeValue="";g.parentNode&&g.parentNode.removeChild(g)})})}},
parseMemoText:function(a){return(a=a.match(/^\[ko_memo\:(.*?)\]$/))?a[1]:null}}}();ko.exportSymbol("ko.memoization",ko.memoization);ko.exportSymbol("ko.memoization.memoize",ko.memoization.memoize);ko.exportSymbol("ko.memoization.unmemoize",ko.memoization.unmemoize);ko.exportSymbol("ko.memoization.parseMemoText",ko.memoization.parseMemoText);ko.exportSymbol("ko.memoization.unmemoizeDomNodeAndDescendants",ko.memoization.unmemoizeDomNodeAndDescendants);
ko.subscription=function(a,c){this.callback=a;this.dispose=function(){this.isDisposed=!0;c()}.bind(this);ko.exportProperty(this,"dispose",this.dispose)};
ko.subscribable=function(){var a=[];this.subscribe=function(c,d){var b=d?c.bind(d):c,e=new ko.subscription(b,function(){ko.utils.arrayRemoveItem(a,e)});a.push(e);return e};this.notifySubscribers=function(c){ko.utils.arrayForEach(a.slice(0),function(a){a&&!0!==a.isDisposed&&a.callback(c)})};this.getSubscriptionsCount=function(){return a.length};ko.exportProperty(this,"subscribe",this.subscribe);ko.exportProperty(this,"notifySubscribers",this.notifySubscribers);ko.exportProperty(this,"getSubscriptionsCount",
this.getSubscriptionsCount)};ko.isSubscribable=function(a){return"function"==typeof a.subscribe&&"function"==typeof a.notifySubscribers};ko.exportSymbol("ko.subscribable",ko.subscribable);ko.exportSymbol("ko.isSubscribable",ko.isSubscribable);ko.dependencyDetection=function(){var a=[];return{begin:function(){a.push([])},end:function(){return a.pop()},registerDependency:function(c){if(!ko.isSubscribable(c))throw"Only subscribable things can act as dependencies";0<a.length&&a[a.length-1].push(c)}}}();
var primitiveTypes={undefined:!0,"boolean":!0,number:!0,string:!0};function valuesArePrimitiveAndEqual(a,c){return null===a||typeof a in primitiveTypes?a===c:!1}
ko.observable=function(a){function c(){if(0<arguments.length){if(!c.equalityComparer||!c.equalityComparer(d,arguments[0]))d=arguments[0],c.notifySubscribers(d);return this}ko.dependencyDetection.registerDependency(c);return d}var d=a;c.__ko_proto__=ko.observable;c.valueHasMutated=function(){c.notifySubscribers(d)};c.equalityComparer=valuesArePrimitiveAndEqual;ko.subscribable.call(c);ko.exportProperty(c,"valueHasMutated",c.valueHasMutated);return c};
ko.isObservable=function(a){return null===a||void 0===a||void 0===a.__ko_proto__?!1:a.__ko_proto__===ko.observable?!0:ko.isObservable(a.__ko_proto__)};ko.isWriteableObservable=function(a){return"function"==typeof a&&a.__ko_proto__===ko.observable||"function"==typeof a&&a.__ko_proto__===ko.dependentObservable&&a.hasWriteFunction?!0:!1};ko.exportSymbol("ko.observable",ko.observable);ko.exportSymbol("ko.isObservable",ko.isObservable);ko.exportSymbol("ko.isWriteableObservable",ko.isWriteableObservable);
ko.observableArray=function(a){0==arguments.length&&(a=[]);if(null!==a&&void 0!==a&&!("length"in a))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");var c=new ko.observable(a);ko.utils.arrayForEach("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){c[a]=function(){var b=c(),b=b[a].apply(b,arguments);c.valueHasMutated();return b}});ko.utils.arrayForEach(["slice"],function(a){c[a]=function(){var b=c();return b[a].apply(b,
arguments)}});c.remove=function(a){for(var b=c(),e=[],f=[],h="function"==typeof a?a:function(b){return b===a},i=0,g=b.length;i<g;i++){var j=b[i];h(j)?f.push(j):e.push(j)}c(e);return f};c.removeAll=function(a){if(void 0===a){var b=c();c([]);return b}return!a?[]:c.remove(function(b){return 0<=ko.utils.arrayIndexOf(a,b)})};c.destroy=function(a){for(var b=c(),e="function"==typeof a?a:function(b){return b===a},f=b.length-1;0<=f;f--)e(b[f])&&(b[f]._destroy=!0);c.valueHasMutated()};c.destroyAll=function(a){return void 0===
a?c.destroy(function(){return!0}):!a?[]:c.destroy(function(b){return 0<=ko.utils.arrayIndexOf(a,b)})};c.indexOf=function(a){var b=c();return ko.utils.arrayIndexOf(b,a)};c.replace=function(a,b){var e=c.indexOf(a);0<=e&&(c()[e]=b,c.valueHasMutated())};ko.exportProperty(c,"remove",c.remove);ko.exportProperty(c,"removeAll",c.removeAll);ko.exportProperty(c,"destroy",c.destroy);ko.exportProperty(c,"destroyAll",c.destroyAll);ko.exportProperty(c,"indexOf",c.indexOf);return c};
ko.exportSymbol("ko.observableArray",ko.observableArray);
ko.dependentObservable=function(a,c,d){function b(){ko.utils.arrayForEach(l,function(a){a.dispose()});l=[]}function e(a){b();ko.utils.arrayForEach(a,function(a){l.push(a.subscribe(f))})}function f(){if(g&&"function"==typeof d.disposeWhen&&d.disposeWhen())h.dispose();else{try{ko.dependencyDetection.begin(),i=d.owner?d.read.call(d.owner):d.read()}finally{var a=ko.utils.arrayGetDistinctValues(ko.dependencyDetection.end());e(a)}h.notifySubscribers(i);g=!0}}function h(){if(0<arguments.length)if("function"===
typeof d.write){var a=arguments[0];d.owner?d.write.call(d.owner,a):d.write(a)}else throw"Cannot write a value to a dependentObservable unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.";else return g||f(),ko.dependencyDetection.registerDependency(h),i}var i,g=!1;a&&"object"==typeof a?d=a:(d=d||{},d.read=a||d.read,d.owner=c||d.owner);if("function"!=typeof d.read)throw"Pass a function that returns the value of the dependentObservable";var j="object"==
typeof d.disposeWhenNodeIsRemoved?d.disposeWhenNodeIsRemoved:null,k=null;if(j){k=function(){h.dispose()};ko.utils.domNodeDisposal.addDisposeCallback(j,k);var m=d.disposeWhen;d.disposeWhen=function(){return!ko.utils.domNodeIsAttachedToDocument(j)||"function"==typeof m&&m()}}var l=[];h.__ko_proto__=ko.dependentObservable;h.getDependenciesCount=function(){return l.length};h.hasWriteFunction="function"===typeof d.write;h.dispose=function(){j&&ko.utils.domNodeDisposal.removeDisposeCallback(j,k);b()};ko.subscribable.call(h);
!0!==d.deferEvaluation&&f();ko.exportProperty(h,"dispose",h.dispose);ko.exportProperty(h,"getDependenciesCount",h.getDependenciesCount);return h};ko.dependentObservable.__ko_proto__=ko.observable;ko.exportSymbol("ko.dependentObservable",ko.dependentObservable);
(function(){function a(b,e,f){f=f||new d;b=e(b);if(!("object"==typeof b&&null!==b&&void 0!==b))return b;var h=b instanceof Array?[]:{};f.save(b,h);c(b,function(d){var c=e(b[d]);switch(typeof c){case "boolean":case "number":case "string":case "function":h[d]=c;break;case "object":case "undefined":var j=f.get(c);h[d]=void 0!==j?j:a(c,e,f)}});return h}function c(a,d){if(a instanceof Array)for(var c=0;c<a.length;c++)d(c);else for(c in a)d(c)}function d(){var a=[],d=[];this.save=function(c,h){var i=ko.utils.arrayIndexOf(a,
c);0<=i?d[i]=h:(a.push(c),d.push(h))};this.get=function(c){c=ko.utils.arrayIndexOf(a,c);return 0<=c?d[c]:void 0}}ko.toJS=function(b){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return a(b,function(a){for(var b=0;ko.isObservable(a)&&10>b;b++)a=a();return a})};ko.toJSON=function(a){a=ko.toJS(a);return ko.utils.stringifyJson(a)}})();ko.exportSymbol("ko.toJS",ko.toJS);ko.exportSymbol("ko.toJSON",ko.toJSON);
(function(){ko.selectExtensions={readValue:function(a){return"OPTION"==a.tagName?!0===a.__ko__hasDomDataOptionValue__?ko.utils.domData.get(a,ko.bindingHandlers.options.optionValueDomDataKey):a.getAttribute("value"):"SELECT"==a.tagName?0<=a.selectedIndex?ko.selectExtensions.readValue(a.options[a.selectedIndex]):void 0:a.value},writeValue:function(a,c){if("OPTION"==a.tagName)switch(typeof c){case "string":case "number":ko.utils.domData.set(a,ko.bindingHandlers.options.optionValueDomDataKey,void 0);
"__ko__hasDomDataOptionValue__"in a&&delete a.__ko__hasDomDataOptionValue__;a.value=c;break;default:ko.utils.domData.set(a,ko.bindingHandlers.options.optionValueDomDataKey,c),a.__ko__hasDomDataOptionValue__=!0,a.value=""}else if("SELECT"==a.tagName)for(var d=a.options.length-1;0<=d;d--){if(ko.selectExtensions.readValue(a.options[d])==c){a.selectedIndex=d;break}}else{if(null===c||void 0===c)c="";a.value=c}}}})();ko.exportSymbol("ko.selectExtensions",ko.selectExtensions);
ko.exportSymbol("ko.selectExtensions.readValue",ko.selectExtensions.readValue);ko.exportSymbol("ko.selectExtensions.writeValue",ko.selectExtensions.writeValue);
ko.jsonExpressionRewriting=function(){function a(a,b){return a.replace(d,function(a,d){return b[d]})}function c(a){return 0<=ko.utils.arrayIndexOf(e,ko.utils.stringTrim(a).toLowerCase())?!1:"<"==a[0]&&">"==a[a.length-1]?!0:null!==a.match(b)}var d=/\[ko_token_(\d+)\]/g,b=/^[\_$a-z][\_$a-z0-9]*(\[.*?\])*(\.[\_$a-z][\_$a-z0-9]*(\[.*?\])*)*$/i,e=["true","false"];return{parseJson:function(b){b=ko.utils.stringTrim(b);if(3>b.length)return{};for(var d=[],c=null,g,e,k="{"==b.charAt(0)?1:0;k<b.length;k++){var m=
b.charAt(k);if(null===c)switch(m){case '"':case "'":case "/":c=k;g=m;break;case "<":c=k;g=">";break;case "{":c=k;e=1;g="}";break;case "[":c=k,g="]"}else if("}"==g&&"{"==m)e++;else if("}"==g&&"}"==m&&1<e)e--;else if(m==g){m=b.substring(c,k+1);d.push(m);var l="[ko_token_"+(d.length-1)+"]",b=b.substring(0,c)+l+b.substring(k+1),k=k-(m.length-l.length),c=null}}c={};b=b.split(",");g=0;for(e=b.length;g<e;g++)m=b[g],l=m.indexOf(":"),0<l&&l<m.length-1&&(k=ko.utils.stringTrim(m.substring(0,l)),m=ko.utils.stringTrim(m.substring(l+
1)),"{"==k.charAt(0)&&(k=k.substring(1)),"}"==m.charAt(m.length-1)&&(m=m.substring(0,m.length-1)),k=ko.utils.stringTrim(a(k,d)),m=ko.utils.stringTrim(a(m,d)),c[k]=m);return c},insertPropertyAccessorsIntoJson:function(a){var b=ko.jsonExpressionRewriting.parseJson(a),d=[],g;for(g in b){var e=b[g];c(e)&&(0<d.length&&d.push(", "),d.push(g+" : function(__ko_value) { "+e+" = __ko_value; }"))}0<d.length&&(b=d.join(""),a=a+", '_ko_property_writers' : { "+b+" } ");return a},parseURIsInJSONString:function(a){for(var b=
/["']?(<|\[)[a-z:\/.#?&%]+(\]|>)['"]?/g,d="",c=b.exec(a);null!=c;){if(("'"===c[0][0]||'"'===c[0][0])&&("'"===c[0][c[0].length-1]||'"'===c[0][c[0].length-1]))a=a.split(c[0]),d=d+a[0]+c[0],a=a[1];else var e=c[0],c=c.index,d=a.substring(0,c)+"sko.current().tryProperty('"+e+"')",a=a.substring(c+e.length);c=b.exec(a)}return d+a},insertPropertyReaderWritersIntoJson:function(a){var a=ko.jsonExpressionRewriting.parseJson(a),b=[],d="",e=!0,j;for(j in a){var k=a[j],k=this.parseURIsInJSONString(k);c(k)&&(0<
b.length&&b.push(", "),"<"===k[0]&&">"===k[k.length-1]&&"about"!==j&&"rel"!==j?b.push(j+" : function(__ko_value) { sko.current = function() { return sko.currentResource(innerNode); }; sko.current().tryProperty('"+k+"') = __ko_value; }"):null!=k.match(/^\[[^,;"\]\}\{\[\.:]+:[^,;"\}\]\{\[\.:]+\]$/)&&"about"!==j&&"rel"!==j?b.push(j+" : function(__ko_value) { sko.current = function() { return sko.currentResource(innerNode); }; sko.current().tryProperty('"+k+"') = __ko_value; }"):"<"===k[0]&&">"===k[k.length-
1]&&("about"===j||"rel"===j)||"["===k[0]&&"]"===k[k.length-1]&&("about"===j||"rel"===j)||(/tryProperty\([^)]+\)$/.test(k)||/prop\([^)]+\)$/.test(k)?b.push(j+" : function(__ko_value) { sko.current = function() { return sko.currentResource(innerNode); }; "+k+"(__ko_value); }"):b.push(j+" : function(__ko_value) { sko.current = function() { return sko.currentResource(innerNode); }; "+k+" = __ko_value; }")));e?e=!1:d+=", ";d="<"===k[0]&&">"===k[k.length-1]&&"about"!==j&&"rel"!==j?d+j+": (function(){ sko.current = function() { return sko.currentResource(innerNode); }; return sko.current().tryProperty('"+
k+"') })()":null!=k.match(/^\[[^,;"\]\}\{\[\.:]+:[^,;"\}\]\{\[\.:]+\]$/)&&"about"!==j&&"rel"!==j?d+j+": (function(){ sko.current = function() { return sko.currentResource(innerNode); }; return sko.current().tryProperty('"+k+"') })()":"<"===k[0]&&">"===k[k.length-1]&&("about"===j||"rel"===j)?d+j+": '"+k.slice(1,k.length-1)+"'":null!=k.match(/^\[[^,;"\]\}\{\[\.:]+:[^,;"\}\]\{\[\.:]+\]$/)&&("about"===j||"rel"===j)?d+j+": sko.rdf.prefixes.resolve('"+k.slice(1,k.length-1)+"')":d+j+": (function(){ sko.current = function() { return sko.currentResource(innerNode); }; return "+
k+" })()"}a=d;0<b.length&&(b=b.join(""),a=a+", '_ko_property_writers' : { "+b+" } ");return a}}}();ko.exportSymbol("ko.jsonExpressionRewriting",ko.jsonExpressionRewriting);ko.exportSymbol("ko.jsonExpressionRewriting.parseJson",ko.jsonExpressionRewriting.parseJson);ko.exportSymbol("ko.jsonExpressionRewriting.insertPropertyAccessorsIntoJson",ko.jsonExpressionRewriting.insertPropertyAccessorsIntoJson);ko.exportSymbol("ko.jsonExpressionRewriting.insertPropertyReaderWritersIntoJson",ko.jsonExpressionRewriting.insertPropertyReaderWritersIntoJson);
(function(){ko.bindingHandlers={};ko.applyBindingsToNode=function(a,c,d,b){function e(a){return function(){return i[a]}}function f(){return i}var h=!0,b=b||"data-bind",i;new ko.dependentObservable(function(){var g;if("function"==typeof c){d.skonode=a;with(d)g=c()}else g=c;if(!g)a:{var j=a.getAttribute(b);try{var k=" { "+ko.jsonExpressionRewriting.insertPropertyReaderWritersIntoJson(j)+" } ";g=ko.utils.evalWithinScope(k,null===d?window:d,a);break a}catch(m){"undefined"!==typeof console&&(console.log("!!! ERROR"),
console.log(j),console.log(m))}g=void 0}i=g;if(h)for(var l in i)ko.bindingHandlers[l]&&"function"==typeof ko.bindingHandlers[l].init&&(k=e(l),(0,ko.bindingHandlers[l].init)(a,k,f,d));for(l in i)ko.bindingHandlers[l]&&"function"==typeof ko.bindingHandlers[l].update&&(k=e(l),(0,ko.bindingHandlers[l].update)(a,k,f,d))},null,{disposeWhenNodeIsRemoved:a});h=!1};ko.applyBindings=function(a,c){if(c&&void 0==c.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node (note: this is a breaking change since KO version 1.05)");
var c=c||window.document.body,d=ko.utils.getElementsHavingAttribute(c,"data-bind");ko.utils.arrayForEach(d,function(b){ko.applyBindingsToNode(b,null,a)})};ko.exportSymbol("ko.bindingHandlers",ko.bindingHandlers);ko.exportSymbol("ko.applyBindings",ko.applyBindings);ko.exportSymbol("ko.applyBindingsToNode",ko.applyBindingsToNode)})();var eventHandlersWithShortcuts=["click"];
ko.utils.arrayForEach(eventHandlersWithShortcuts,function(a){ko.bindingHandlers[a]={init:function(c,d,b,e){return ko.bindingHandlers.event.init.call(this,c,function(){var b={};b[a]=d();return b},b,e)}}});
ko.bindingHandlers.event={init:function(a,c,d,b){var e=c()||{},f;for(f in e)(function(){var e=f;"string"==typeof e&&ko.utils.registerEventHandler(a,e,function(a){var g,f=c()[e];if(f){var k=d();try{g=f.apply(b,arguments)}finally{!0!==g&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}!1===k[e+"Bubble"]&&(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation())}})})()}};
ko.bindingHandlers.submit={init:function(a,c,d,b){if("function"!=typeof c())throw Error("The value for a submit binding must be a function to invoke on submit");ko.utils.registerEventHandler(a,"submit",function(d){var f,h=c();try{f=h.call(b,a)}finally{!0!==f&&(d.preventDefault?d.preventDefault():d.returnValue=!1)}})}};ko.bindingHandlers.visible={update:function(a,c){var d=ko.utils.unwrapObservable(c()),b="none"!=a.style.display;d&&!b?a.style.display="":!d&&b&&(a.style.display="none")}};
ko.bindingHandlers.enable={update:function(a,c){var d=ko.utils.unwrapObservable(c());d&&a.disabled?a.removeAttribute("disabled"):!d&&!a.disabled&&(a.disabled=!0)}};ko.bindingHandlers.disable={update:function(a,c){ko.bindingHandlers.enable.update(a,function(){return!ko.utils.unwrapObservable(c())})}};
ko.bindingHandlers.value={init:function(a,c,d){var b=["change"],e=d().valueUpdate;e&&("string"==typeof e&&(e=[e]),ko.utils.arrayPushAll(b,e),b=ko.utils.arrayGetDistinctValues(b));ko.utils.arrayForEach(b,function(b){var e=!1;ko.utils.stringStartsWith(b,"after")&&(e=!0,b=b.substring(5));var i=e?function(a){setTimeout(a,0)}:function(a){a()};ko.utils.registerEventHandler(a,b,function(){i(function(){var b=c(),e=ko.selectExtensions.readValue(a);ko.isWriteableObservable(b)?b(e):(b=d(),b._ko_property_writers&&
b._ko_property_writers.value&&b._ko_property_writers.value(e))})})})},update:function(a,c){var d=ko.utils.unwrapObservable(c()),b=ko.selectExtensions.readValue(a),e=d!=b;0===d&&0!==b&&"0"!==b&&(e=!0);e&&(b=function(){ko.selectExtensions.writeValue(a,d)},b(),"SELECT"==a.tagName&&setTimeout(b,0));"SELECT"==a.tagName&&(b=ko.selectExtensions.readValue(a),b!==d&&ko.utils.triggerEvent(a,"change"))}};
ko.bindingHandlers.options={update:function(a,c,d){if("SELECT"!=a.tagName)throw Error("options binding applies only to SELECT elements");var b=ko.utils.arrayMap(ko.utils.arrayFilter(a.childNodes,function(a){return a.tagName&&"OPTION"==a.tagName&&a.selected}),function(a){return ko.selectExtensions.readValue(a)||a.innerText||a.textContent}),e=a.scrollTop,f=ko.utils.unwrapObservable(c());ko.utils.emptyDomNode(a);if(f){var h=d();"number"!=typeof f.length&&(f=[f]);if(h.optionsCaption){var i=document.createElement("OPTION");
i.innerHTML=h.optionsCaption;ko.selectExtensions.writeValue(i,void 0);a.appendChild(i)}d=0;for(c=f.length;d<c;d++){var i=document.createElement("OPTION"),g="string"==typeof h.optionsValue?f[d][h.optionsValue]:f[d],g=ko.utils.unwrapObservable(g);ko.selectExtensions.writeValue(i,g);var j=h.optionsText;optionText="function"==typeof j?j(f[d]):"string"==typeof j?f[d][j]:g;if(null===optionText||void 0===optionText)optionText="";optionText=ko.utils.unwrapObservable(optionText).toString();"string"==typeof i.innerText?
i.innerText=optionText:i.textContent=optionText;a.appendChild(i)}f=a.getElementsByTagName("OPTION");d=h=0;for(c=f.length;d<c;d++)0<=ko.utils.arrayIndexOf(b,ko.selectExtensions.readValue(f[d]))&&(ko.utils.setOptionNodeSelectionState(f[d],!0),h++);e&&(a.scrollTop=e)}}};ko.bindingHandlers.options.optionValueDomDataKey="__ko.bindingHandlers.options.optionValueDomData__";
ko.bindingHandlers.selectedOptions={getSelectedValuesFromSelectNode:function(a){for(var c=[],a=a.childNodes,d=0,b=a.length;d<b;d++){var e=a[d];"OPTION"==e.tagName&&e.selected&&c.push(ko.selectExtensions.readValue(e))}return c},init:function(a,c,d){ko.utils.registerEventHandler(a,"change",function(){var a=c();ko.isWriteableObservable(a)?a(ko.bindingHandlers.selectedOptions.getSelectedValuesFromSelectNode(this)):(a=d(),a._ko_property_writers&&a._ko_property_writers.value&&a._ko_property_writers.value(ko.bindingHandlers.selectedOptions.getSelectedValuesFromSelectNode(this)))})},
update:function(a,c){if("SELECT"!=a.tagName)throw Error("values binding applies only to SELECT elements");var d=ko.utils.unwrapObservable(c());if(d&&"number"==typeof d.length)for(var b=a.childNodes,e=0,f=b.length;e<f;e++){var h=b[e];"OPTION"==h.tagName&&ko.utils.setOptionNodeSelectionState(h,0<=ko.utils.arrayIndexOf(d,ko.selectExtensions.readValue(h)))}}};
ko.bindingHandlers.text={update:function(a,c){var d=ko.utils.unwrapObservable(c());if(null===d||void 0===d)d="";"string"==typeof a.innerText?a.innerText=d:a.textContent=d}};ko.bindingHandlers.html={update:function(a,c){var d=ko.utils.unwrapObservable(c());ko.utils.setHtml(a,d)}};ko.bindingHandlers.css={update:function(a,c){var d=ko.utils.unwrapObservable(c()||{}),b;for(b in d)if("string"==typeof b){var e=ko.utils.unwrapObservable(d[b]);ko.utils.toggleDomNodeCssClass(a,b,e)}}};
ko.bindingHandlers.style={update:function(a,c){var d=ko.utils.unwrapObservable(c()||{}),b;for(b in d)if("string"==typeof b){var e=ko.utils.unwrapObservable(d[b]);a.style[b]=e||""}}};ko.bindingHandlers.uniqueName={init:function(a,c){c()&&(a.name="ko_unique_"+ ++ko.bindingHandlers.uniqueName.currentIndex,ko.utils.isIe6&&a.mergeAttributes(document.createElement("<input name='"+a.name+"'/>"),!1))}};ko.bindingHandlers.uniqueName.currentIndex=0;
ko.bindingHandlers.checked={init:function(a,c,d){ko.utils.registerEventHandler(a,"click",function(){var b;if("checkbox"==a.type)b=a.checked;else if("radio"==a.type&&a.checked)b=a.value;else return;var e=c();"checkbox"==a.type&&ko.utils.unwrapObservable(e)instanceof Array?(b=ko.utils.arrayIndexOf(ko.utils.unwrapObservable(e),a.value),a.checked&&0>b?e.push(a.value):!a.checked&&0<=b&&e.splice(b,1)):ko.isWriteableObservable(e)?e()!==b&&e(b):(e=d(),e._ko_property_writers&&e._ko_property_writers.checked&&
e._ko_property_writers.checked(b))});"radio"==a.type&&!a.name&&ko.bindingHandlers.uniqueName.init(a,function(){return!0})},update:function(a,c){var d=ko.utils.unwrapObservable(c());"checkbox"==a.type?(a.checked=d instanceof Array?0<=ko.utils.arrayIndexOf(d,a.value):d,d&&ko.utils.isIe6&&a.mergeAttributes(document.createElement("<input type='checkbox' checked='checked' />"),!1)):"radio"==a.type&&(a.checked=a.value==d,a.value==d&&(ko.utils.isIe6||ko.utils.isIe7)&&a.mergeAttributes(document.createElement("<input type='radio' checked='checked' />"),
!1))}};ko.bindingHandlers.attr={update:function(a,c){var d=ko.utils.unwrapObservable(c())||{},b;for(b in d)if("string"==typeof b){var e=ko.utils.unwrapObservable(d[b]);if(!1===e||null===e||void 0===e)a.removeAttribute(b);else var f=e.toString();"<"===f[0]&&">"===f[f.length-1]&&(f=f.substring(1,f.length-1));a.setAttribute(b,f)}}};
ko.templateEngine=function(){this.renderTemplate=function(){throw"Override renderTemplate in your ko.templateEngine subclass";};this.isTemplateRewritten=function(){throw"Override isTemplateRewritten in your ko.templateEngine subclass";};this.rewriteTemplate=function(){throw"Override rewriteTemplate in your ko.templateEngine subclass";};this.createJavaScriptEvaluatorBlock=function(){throw"Override createJavaScriptEvaluatorBlock in your ko.templateEngine subclass";}};
ko.exportSymbol("ko.templateEngine",ko.templateEngine);
ko.templateRewriting=function(){var a=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi;return{ensureTemplateIsRewritten:function(a,d){d.isTemplateRewritten(a)||d.rewriteTemplate(a,function(a){return ko.templateRewriting.memoizeBindingAttributeSyntax(a,d)})},memoizeBindingAttributeSyntax:function(c,d){return c.replace(a,function(a,c,f,h,i,g,j){a=ko.jsonExpressionRewriting.insertPropertyReaderWritersIntoJson(j);return d.createJavaScriptEvaluatorBlock("ko.templateRewriting.applyMemoizedBindingsToNextSibling(function() {                     return (function() { var innerNode=skonode; return { "+
a+" } })()                 })")+c})},applyMemoizedBindingsToNextSibling:function(a){return ko.memoization.memoize(function(d,b){d.nextSibling&&sko.traceResources(d.nextSibling,b,function(){sko.traceRelations(d.nextSibling,b,function(){ko.applyBindingsToNode(d.nextSibling,a,b)})})})}}}();ko.exportSymbol("ko.templateRewriting",ko.templateRewriting);ko.exportSymbol("ko.templateRewriting.applyMemoizedBindingsToNextSibling",ko.templateRewriting.applyMemoizedBindingsToNextSibling);
(function(){function a(a,b,e,f,h){var i=ko.utils.unwrapObservable(f),h=h||{},g=h.templateEngine||c;ko.templateRewriting.ensureTemplateIsRewritten(e,g);e=g.renderTemplate(e,i,h);if("number"!=typeof e.length||0<e.length&&"number"!=typeof e[0].nodeType)throw"Template engine must return an array of DOM nodes";switch(b){case "replaceChildren":ko.utils.setDomNodeChildren(a,e);break;case "replaceNode":ko.utils.replaceDomNodes(a,e);break;case "ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+
b);}e&&ko.utils.arrayForEach(e,function(a){ko.memoization.unmemoizeDomNodeAndDescendants(a,[f])});h.afterRender&&h.afterRender(e,f);return e}var c;ko.setTemplateEngine=function(a){if(void 0!=a&&!(a instanceof ko.templateEngine))throw"templateEngine must inherit from ko.templateEngine";c=a};ko.renderTemplate=function(d,b,e,f,h){e=e||{};if(void 0==(e.templateEngine||c))throw"Set a template engine before calling renderTemplate";h=h||"replaceChildren";if(f){var i=f.nodeType?f:0<f.length?f[0]:null;return new ko.dependentObservable(function(){var c=
"function"==typeof d?d(b):d,c=a(f,h,c,b,e);"replaceNode"==h&&(f=c,i=f.nodeType?f:0<f.length?f[0]:null)},null,{disposeWhen:function(){return!i||!ko.utils.domNodeIsAttachedToDocument(i)},disposeWhenNodeIsRemoved:i&&"replaceNode"==h?i.parentNode:i})}return ko.memoization.memoize(function(a){ko.renderTemplate(d,b,e,a,"replaceNode")})};ko.renderTemplateForEach=function(d,b,c,f){return new ko.dependentObservable(function(){var h=ko.utils.unwrapObservable(b)||[];h.constructor!=Array&&(h=[h]);for(var i=0;i<
h.length;i++)if("number"===typeof h[i]||"string"===typeof h[i]){var g={$value:h[i]},j;for(j in viewModel)g[j]=viewModel[j];h[i]=g}h=ko.utils.arrayFilter(h,function(a){return c.includeDestroyed||!a._destroy});ko.utils.setDomNodeChildrenFromArrayMapping(f,h,function(b){var g="function"==typeof d?d(b):d;return a(null,"ignoreTargetNode",g,b,c)},c)},null,{disposeWhenNodeIsRemoved:f})};ko.bindingHandlers.template={update:function(a,b,c,f){b=ko.utils.unwrapObservable(b());c="string"==typeof b?b:b.name;if("undefined"!=
typeof b.foreach)f=ko.renderTemplateForEach(c,b.foreach||[],{templateOptions:b.templateOptions,afterAdd:b.afterAdd,beforeRemove:b.beforeRemove,includeDestroyed:b.includeDestroyed,afterRender:b.afterRender},a);else var h=b.data,f=ko.renderTemplate(c,"undefined"==typeof h?f:h,{templateOptions:b.templateOptions,afterRender:b.afterRender},a);(b=ko.utils.domData.get(a,"__ko__templateSubscriptionDomDataKey__"))&&"function"==typeof b.dispose&&b.dispose();ko.utils.domData.set(a,"__ko__templateSubscriptionDomDataKey__",
f)}}})();ko.exportSymbol("ko.setTemplateEngine",ko.setTemplateEngine);ko.exportSymbol("ko.renderTemplate",ko.renderTemplate);
(function(){ko.utils.compareArrays=function(a,c,d){if(void 0===d)return ko.utils.compareArrays(a,c,1)||ko.utils.compareArrays(a,c,10)||ko.utils.compareArrays(a,c,Number.MAX_VALUE);for(var a=a||[],c=c||[],b=a,e=c,f=[],h=0;h<=e.length;h++)f[h]=[];for(var h=0,i=Math.min(b.length,d);h<=i;h++)f[0][h]=h;h=1;for(i=Math.min(e.length,d);h<=i;h++)f[h][0]=h;for(var i=b.length,g,j=e.length,h=1;h<=i;h++){g=Math.max(1,h-d);for(var k=Math.min(j,h+d);g<=k;g++)f[g][h]=b[h-1]===e[g-1]?f[g-1][h-1]:Math.min(void 0===
f[g-1][h]?Number.MAX_VALUE:f[g-1][h]+1,void 0===f[g][h-1]?Number.MAX_VALUE:f[g][h-1]+1)}d=a.length;b=c.length;e=[];h=f[b][d];if(void 0===h)f=null;else{for(;0<d||0<b;){i=f[b][d];j=0<b?f[b-1][d]:h+1;k=0<d?f[b][d-1]:h+1;g=0<b&&0<d?f[b-1][d-1]:h+1;if(void 0===j||j<i-1)j=h+1;if(void 0===k||k<i-1)k=h+1;g<i-1&&(g=h+1);j<=k&&j<g?(e.push({status:"added",value:c[b-1]}),b--):(k<j&&k<g?e.push({status:"deleted",value:a[d-1]}):(e.push({status:"retained",value:a[d-1]}),b--),d--)}f=e.reverse()}return f}})();
ko.exportSymbol("ko.utils.compareArrays",ko.utils.compareArrays);
(function(){function a(a,d,b){var e=[],a=ko.dependentObservable(function(){var a=d(b)||[];0<e.length&&ko.utils.replaceDomNodes(e,a);e.splice(0,e.length);ko.utils.arrayPushAll(e,a)},null,{disposeWhenNodeIsRemoved:a,disposeWhen:function(){return 0==e.length||!ko.utils.domNodeIsAttachedToDocument(e[0])}});return{mappedNodes:e,dependentObservable:a}}ko.utils.setDomNodeChildrenFromArrayMapping=function(c,d,b,e){for(var d=d||[],e=e||{},f=void 0===ko.utils.domData.get(c,"setDomNodeChildrenFromArrayMapping_lastMappingResult"),
h=ko.utils.domData.get(c,"setDomNodeChildrenFromArrayMapping_lastMappingResult")||[],i=ko.utils.arrayMap(h,function(a){return a.arrayEntry}),g=ko.utils.compareArrays(i,d),d=[],j=0,k=[],i=[],m=null,l=0,r=g.length;l<r;l++)switch(g[l].status){case "retained":var n=h[j];d.push(n);0<n.domNodes.length&&(m=n.domNodes[n.domNodes.length-1]);j++;break;case "deleted":h[j].dependentObservable.dispose();ko.utils.arrayForEach(h[j].domNodes,function(a){k.push({element:a,index:l,value:g[l].value});m=a});j++;break;
case "added":var o=a(c,b,g[l].value),n=o.mappedNodes;d.push({arrayEntry:g[l].value,domNodes:n,dependentObservable:o.dependentObservable});for(var o=0,s=n.length;o<s;o++){var p=n[o];i.push({element:p,index:l,value:g[l].value});null==m?c.firstChild?c.insertBefore(p,c.firstChild):c.appendChild(p):m.nextSibling?c.insertBefore(p,m.nextSibling):c.appendChild(p);m=p}}ko.utils.arrayForEach(k,function(a){ko.cleanNode(a.element)});b=!1;if(!f){if(e.afterAdd)for(l=0;l<i.length;l++)e.afterAdd(i[l].element,i[l].index,
i[l].value);if(e.beforeRemove){for(l=0;l<k.length;l++)e.beforeRemove(k[l].element,k[l].index,k[l].value);b=!0}}b||ko.utils.arrayForEach(k,function(a){a.element.parentNode&&a.element.parentNode.removeChild(a.element)});ko.utils.domData.set(c,"setDomNodeChildrenFromArrayMapping_lastMappingResult",d)}})();ko.exportSymbol("ko.utils.setDomNodeChildrenFromArrayMapping",ko.utils.setDomNodeChildrenFromArrayMapping);
ko.jqueryTmplTemplateEngine=function(){var a;a="undefined"==typeof jQuery||!jQuery.tmpl?0:jQuery.tmpl.tag?jQuery.tmpl.tag.tmpl&&jQuery.tmpl.tag.tmpl.open&&0<=jQuery.tmpl.tag.tmpl.open.toString().indexOf("__")?3:2:1;this.jQueryTmplVersion=a;this.getTemplateNode=function(a){var b=document.getElementById(a);if(null==b)throw Error("Cannot find template with ID="+a);return b};var c=RegExp("__ko_apos__","g");this.renderTemplate=function(a,b,e){e=e||{};if(0==this.jQueryTmplVersion)throw Error("jquery.tmpl not detected.\nTo use KO's default template engine, reference jQuery and jquery.tmpl. See Knockout installation documentation for more details.");
if(1==this.jQueryTmplVersion)return a='<script type="text/html">'+this.getTemplateNode(a).text+"<\/script>",b=jQuery.tmpl(a,b)[0].text.replace(c,"'"),jQuery.clean([b],document);if(!(a in jQuery.template)){var f=this.getTemplateNode(a).text;jQuery.template(a,f)}b=[b];b=jQuery.tmpl(a,b,e.templateOptions);b.appendTo(document.createElement("div"));jQuery.fragments={};return b};this.isTemplateRewritten=function(a){return a in jQuery.template?!0:!0===this.getTemplateNode(a).isRewritten};this.rewriteTemplate=
function(a,b){var c=this.getTemplateNode(a),f=b(c.text);1==this.jQueryTmplVersion&&(f=ko.utils.stringTrim(f),f=f.replace(/([\s\S]*?)(\${[\s\S]*?}|{{[\=a-z][\s\S]*?}}|$)/g,function(a,b,d){return b.replace(/\'/g,"__ko_apos__")+d}));c.text=f;c.isRewritten=!0};this.createJavaScriptEvaluatorBlock=function(a){a=function(a){var d=/<\$[^>]*>/g;if(1<a.split(d).length){var c="",h=null;a.replace(d,function(a,b,d){null===h&&(h=d);b=h.split(a);c=c+b[0]+a.replace(/</,"<'+").replace(/>/,"+'>");b.shift();1===b.length?
c+=b[0]:h=b.join(a)});return c}return a}(a);return 1==this.jQueryTmplVersion?"{{= "+a+"}}":"{{ko_code ((function() { return "+a+" })()) }}"};this.addTemplate=function(a,b){document.write("<script type='text/html' id='"+a+"'>"+b+"<\/script>")};ko.exportProperty(this,"addTemplate",this.addTemplate);1<this.jQueryTmplVersion&&(jQuery.tmpl.tag.ko_code={open:(3>this.jQueryTmplVersion?"_":"__")+".push($1 || '');"})};ko.jqueryTmplTemplateEngine.prototype=new ko.templateEngine;ko.setTemplateEngine(new ko.jqueryTmplTemplateEngine);
ko.exportSymbol("ko.jqueryTmplTemplateEngine",ko.jqueryTmplTemplateEngine);Utils={stackCounterLimit:1E3,stackCounter:0};Utils.recur=function(a){Utils.stackCounter===Utils.stackCounterLimit?(Utils.stackCounter=0,setTimeout(a,0)):(Utils.stackCounter++,a())};Utils.repeat=function(a,c,d,b,e){4===arguments.length&&(e={});a<c?(e._i=a,d(function(d,e){Utils.recur(function(){Utils.repeat(a+1,c,d,b,e)})},e)):b(e)};SemanticKnockOut={};window.sko=SemanticKnockOut;sko.activeDebug=!1;
sko.log=function(a){sko.activeDebug&&"undefined"!=typeof console&&console.log&&console.log(a)};sko.VERSION="0.1.0";
sko.jsonld={coerce:function(a,c,d){null==a["@context"]&&(a["@context"]={});if(null==a["@context"]["@coerce"])a["@context"]["@coerce"]={},a["@context"]["@coerce"][d]=c;else if("string"===typeof a["@context"]["@coerce"][d]&&a["@context"]["@coerce"][d]!=c)a["@context"]["@coerce"][d]=[a["@context"]["@coerce"][d],c];else if("object"===typeof a["@context"]["@coerce"][d]){for(var b=0;b<a["@context"]["@coerce"][d].length;b++)if(a["@context"]["@coerce"][d][b]===c)return a;a["@context"]["@coerce"][d].push(c)}else a["@context"]["@coerce"][d]=
c;return a},graphToJSONLD:function(a,c){var d={};a.forEach(function(a){var b=a.subject.valueOf(),e=d[b];null==e&&(e={"@subject":b,"@context":{}},d[b]=e);var g=a.predicate.valueOf();"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===g&&(g="@type");var b=null,j=!1,b=c.prefixes.shrink(g);b!=g&&(j=!0);-1!=b.indexOf("#")?b=b.split("#")[1]:(b=b.split("/"),b=b[b.length-1]);g=a.object.valueOf();null!=e[b]?j?(a=b.split(":")[0],"object"===typeof e[b]?e[b].push(g):(g=[e[b],g],e[b]=g)):null!=e["@context"][b]||
"@"===b[0]?"object"===typeof e[b]?e[b].push(g):(g=[e[b],g],e[b]=g):(b=a.predicate.valueOf(),null==e[b]?e[b]=g:"object"===typeof e[b]?e[b].push(g):(g=[e[b],g],e[b]=g),"string"===typeof g&&(0==g.indexOf("http://")||0==g.indexOf("https://"))&&sko.jsonld.coerce(e,b,"@iri")):(e[b]=g,"@"!=b[0]&&(j?(a=b.split(":")[0],e["@context"][a]=c.prefixes[a]):e["@context"][b]=a.predicate.valueOf(),"string"===typeof g&&(0==g.indexOf("http://")||0==g.indexOf("https://"))&&sko.jsonld.coerce(e,b,"@iri")))});var b=[],e;
for(e in d)b.push(d[e]);return b}};sko.Class={};sko.Class.Clone=function(){};sko.Class.registry={};sko.Class.define=function(a,c){sko.Class.registry[sko.NTUri(a.replace(/\s*/g,""))]=c};sko.Class.instance=function(a,c){var d=sko.NTUri(a),b=c||{};sko.Class.Clone.prototype=sko.Class.registry[d];d=new sko.Class.Clone;b.extended=null;for(var e in d)null==b[e]&&(b[e]=d[e]);b.extended&&b.extended();return b};
sko.Class.check=function(a,c){var d=c||!1,b;for(b in sko.Class.registry)if(sko.log("*** IS INSTANCE OF? "+b),sko.Class.isInstance(a,b))sko.log("Y!"),(d||null==a.classes[b])&&sko.Class.instance(b,a),a.classes[b]=!0;else if(sko.log("N!"),null!=a.classes[b]){delete a.classes[b];for(var e in sko.Class.registry[b])delete a[e]}};
sko.Class.isInstance=function(a,c){if(0===c.indexOf("ObjectIntersectionOf(")){for(var d=c.slice(0,c.length-1).split("ObjectIntersectionOf(")[1].split(","),b=0;b<d.length;b++)if(sko.log("INTERSECTION CHECKING "+d[b]),!sko.Class.isInstance(a,d[b]))return!1;return!0}if(0===c.indexOf("ObjectUnionOf(")){d=c.slice(0,c.length-1).split("ObjectUnionOf(")[1].split(",");for(b=0;b<d.length;b++)if(sko.Class.isInstance(a,d[b]))return!0;return!1}if(0===c.indexOf("ObjectSomeValuesFrom(")){d=c.slice(0,c.length-1).split("ObjectSomeValuesFrom(")[1];
sko.log("CHECKIN CLASS URI: "+sko.NTUri(d));for(b in a.valuesMap)sko.log(" - "+b+" ---\> "+a.valuesMap[sko.NTUri(d)]);return null!=a.valuesMap[sko.NTUri(d)]}sko.log("CHECKIN CLASS URI: "+sko.NTUri(c));sko.log(a);for(b in a.classes)sko.log(" - "+b+" ---\> "+a.classes[b]);return!0===a.classes[sko.NTUri(c)]};
sko.ready=function(){sko.aboutResourceMap={};sko.aboutResourceSubscriptionMap={};sko.Class.registry={};sko.aboutCounter=0;sko.generatorId=0;sko.generatorsMap={};var a=null;2===arguments.length?(sko.store=arguments[0],a=arguments[1],sko.rdf=sko.store.rdf,a(!0)):(a=arguments[0],rdfstore.create(function(c){sko.store=c;sko.store.registerDefaultProfileNamespaces();sko.rdf=sko.store.rdf;a(!0)}))};sko.registerPrefix=function(a,c){sko.store.registerDefaultNamespace(a,c)};sko._blankCounter=0;
sko.nextBlankLabel=function(){var a="_:sko_"+sko._blankCounter;sko._blankCounter++;return a};sko.aboutResourceMap={};sko.aboutResourceSubscriptionMap={};sko.aboutCounter=0;
sko.about=function(a,c,d){if(null!=sko.about[a])d(a);else{var b=""+sko.aboutCounter;sko.aboutCounter++;null==a&&(a=sko.nextBlankLabel());if("string"===typeof a){var e=a;sko.store.node(sko.plainUri(e),function(a,c){if(a){sko.log("FOUND RESOURCE: "+e);sko.log(c);sko.log(" FOR "+sko.plainUri(e));sko.log(" ------------\> "+b+" : "+e);sko.aboutResourceMap[b]=new sko.Resource(b,e,c);sko.about[b]=ko.observable(e);var i=sko.about[b].subscribe(function(a){sko.log("*** OBSERVING NODE ABOT ID:"+b+" new value -> "+
a);null==a&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),a=sko.nextBlankLabel());sko.store.node(sko.plainUri(a),function(d,c){if(d){var e=c.toArray()[0].subject.valueOf();sko.log(" ------------\> "+b+" : "+e+" 2");sko.aboutResourceMap[b].about(e)}else sko.log("*** NO RESOURCE FOR URI:"+a),sko.log(" ------------\> "+b+" : "+a+" 3"),sko.aboutResourceMap[b].about(a)})});sko.aboutResourceSubscriptionMap[b]=i}d(b)})}else sko.about[b]=ko.dependentObservable({read:function(){var d=a();sko.log("*** OBSERVABLE READING DEPENDING NODE ABOT ID:"+
b+" new value -> "+d);null==d&&(sko.log(" ** URI IS BLANK -> GEN BLANK LABEL"),d=sko.nextBlankLabel());return d},write:function(d){sko.log("*** OBSERVABLE WRITING DEPENDING NODE ABOT ID:"+b+" new value -> "+d);null==d&&(sko.log(" ** URI IS BLANK -> GEN BLANK LABEL"),d=sko.nextBlankLabel());a(d)},owner:c}),sko.store.node(sko.plainUri(sko.about[b]()),function(a,c){if(a){sko.log(" ------------\> "+b+" : "+c+" 4");sko.aboutResourceMap[b]=new sko.Resource(b,sko.about[b](),c);var e=sko.about[b].subscribe(function(a){sko.log("*** OBSERVING NODE ABOT ID:"+
b+" new value -> "+a);null!=a?sko.store.node(sko.plainUri(a),function(d,c){if(d)if(0<c.toArray().length){var e=c.toArray()[0].subject.toNT();sko.log(" ------------\> "+b+" : "+e+" 5");sko.aboutResourceMap[b].about(e)}else sko.log("*** NO RESOURCE FOR URI:"+a),sko.log(" ------------\> "+b+" : "+a+" 6"),sko.aboutResourceMap[b].about(a);else sko.log("Error updating 3 resource for URI:"+a+" in SKO about node observer"),sko.log("*** NO RESOURCE FOR URI:"+a+" NEXT ID:"+b),sko.log(" ------------\> "+b+" : "+
a+" 7"),sko.aboutResourceMap[b].about(a)}):(sko.log("*** NO RESOURCE FOR URI:"+a),sko.log(" ------------\> "+b+" : NEW BLANK  8"),sko.aboutResourceMap[b].about(sko.nextBlankLabel()))});sko.aboutResourceSubscriptionMap[b]=e}d(b)})}};
sko.rel=function(a,c,d,b){var e=""+sko.aboutCounter,f=null;sko.aboutCounter++;if("string"===typeof a){var h=sko.NTUri(a),f=h;sko.about[e]=ko.dependentObservable({read:function(){sko.log("*** OBSERVABLE READING RELATED  DEPENDING NODE ABOT ID:"+e);var a=sko.currentResource(jQuery(c).parent().toArray()[0]);sko.log(a);if(null!=a){sko.log(" ** about:"+a.about());sko.log("*** Found parent resource: "+a.about());if(a[h]){var b=a[h]();if(null!=b&&!sko.isSKOBlankNode(a[h]()))return b=sko.NTUri(b),null==sko.aboutResourceMap[e]||
sko.aboutResourceMap[e].about()!=b?(sko.log("*** found related resource: "+b),sko.store.node(sko.plainUri(b),function(a,d){sko.log("CREATED NODE FOR ID "+e+" AND URI: "+sko.plainUri(b));sko.log(d);sko.log(" ------------\> "+e+" : "+b+" 8b");sko.aboutResourceMap[e]=new sko.Resource(e,b,d)})):sko.log("*** Related resource hasn't changed"),b;if(null==b){sko.log("*** related resource is null");sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL");var d=sko.nextBlankLabel();sko.log(" ** setting parent node related resource to "+
d);a[h](d)}else sko.aboutResourceMap[e]?(sko.log("*** setting new value for related resource "+d),sko.log(" ------------\> "+e+" : "+d+" 9"),sko.aboutResourceMap[e].about(d)):sko.log("!! Should I create the new blank node?");return d}sko.log("!!! parent resource doest not link to the related resource")}else sko.log("!!! impossible to find parent resource")},write:function(a){null==a&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),a=sko.nextBlankLabel());a=sko.NTUri(a);sko.log("*** OBSERVABLE WRITING RELATED DEPENDING NODE ABOT ID:"+
e+" URI -> "+a);var b=sko.currentResource(jQuery(c).parent().toArray()[0]);null!=b?(sko.log("*** Found parent resource: "+b.about()),b[f]?(sko.log("*** Setting new related resource in parent resource found: "+a),b[f](a)):sko.log("!!! parent resource doest not link to the related resource")):sko.log("!!! impossible to find parent resource")},owner:d});d=sko.about[e].subscribe(function(a){sko.log("*** OBSERVING RELATED NODE ABOT ID:"+e+" new value -> "+a);null==a&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),
a=sko.nextBlankLabel());a=sko.NTUri(a);null!=sko.about[e]()?sko.plainUri(a)!==sko.plainUri(sko.about[e]())&&sko.store.node(sko.plainUri(a),function(b,d){b?(d.toArray(),sko.log(" ------------\> "+e+" : "+h+" 10"),sko.aboutResourceMap[e].about(h)):sko.log("Error updating 1 resource for URI:"+a+" in SKO about related node observer")}):sko.log("!! this resource is now null, should be removed from list of resources?")})}else sko.about[e]=ko.dependentObservable({read:function(){var b;null!=a?(b=a(),b=sko.NTUri(b),
sko.log("*** OBSERVABLE READING RELATED DEPENDING NODE ABOT ID:"+e+" URI -> "+b)):(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),b=sko.nextBlankLabel());var d=sko.currentResource(jQuery(c).parent().toArray()[0]);if(null!=d){sko.log("*** Found parent resource: "+d.about());if(d[b]){var f=d[b]();sko.log("*** found related resource: "+f);sko.store.node(sko.plainUri(f),function(a,b){sko.log(" ------------\> "+e+" : "+f+" 11");sko.aboutResourceMap[e]=new sko.Resource(e,f,b)});return f}sko.log("!!! parent resource doest not link to the related resource")}else sko.log("!!! impossible to find parent resource")},
write:function(b){var b=sko.NTUri(b),d=sko.currentResource(jQuery(c).parent().toArray()[0]);sko.log("*** OBSERVABLE WRITING RELATED DEPENDING NODE ABOT ID:"+e+" URI -> "+b);null==b&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),b=sko.nextBlankLabel());null!=d?(sko.log("*** Found parent resource: "+d.about()),d[a()]?(sko.log("*** Setting new related resource in parent resource found: "+b),d[a()](b),a(b)):sko.log("!!! parent resource doest not link to the related resource")):sko.log("!!! impossible to find parent resource")},
owner:d}),d=sko.about[e].subscribe(function(a){a=sko.NTUri(a);sko.log("*** OBSERVING RELATED NODE (F) ABOT ID:"+e+" new value -> "+a);null==a&&(sko.log(" ** NEXT URI IS NULL, GEN BLANK LABEL"),a=sko.nextBlankLabel());sko.plainUri(a)!=sko.plainUri(sko.about[e]())?sko.store.node(sko.plainUri(a),function(b,d){if(b){var c=d.toArray()[0].subject.valueOf();sko.log(" ------------\> "+e+" : "+c+" 12");sko.aboutResourceMap[e].about(c)}else sko.log("Error updating  2 resource for URI:"+a+" in SKO about related node observer")}):
sko.log("*** Related about resource hasn't changed")});sko.aboutResourceSubscriptionMap[e]=d;b(e)};sko.plainUri=function(a){if("<"===a[0]&&">"==a[a.length-1])return a.slice(1,a.length-1);if(null!=a.match(/\[[^,;"\]\}\{\[\.:]+:[^,;"\}\]\{\[\.:]+\]/)){var a=a.slice(1,a.length-1),c=sko.rdf.prefixes.resolve(a);if(null==c)throw"The CURIE "+a+" cannot be resolved";return c}return a};
sko.effectiveValue=function(a){if(null==a)return null;if(a.interfaceName&&"Literal"===a.interfaceName){if("http://www.w3.org/2001/XMLSchema#integer"==a.datatype||"http://www.w3.org/2001/XMLSchema#decimal"==a.datatype||"http://www.w3.org/2001/XMLSchema#double"==a.datatype||"http://www.w3.org/2001/XMLSchema#nonPositiveInteger"==a.datatype||"http://www.w3.org/2001/XMLSchema#negativeInteger"==a.datatype||"http://www.w3.org/2001/XMLSchema#long"==a.datatype||"http://www.w3.org/2001/XMLSchema#int"==a.datatype||
"http://www.w3.org/2001/XMLSchema#short"==a.datatype||"http://www.w3.org/2001/XMLSchema#byte"==a.datatype||"http://www.w3.org/2001/XMLSchema#nonNegativeInteger"==a.datatype||"http://www.w3.org/2001/XMLSchema#unsignedLong"==a.datatype||"http://www.w3.org/2001/XMLSchema#unsignedInt"==a.datatype||"http://www.w3.org/2001/XMLSchema#unsignedShort"==a.datatype||"http://www.w3.org/2001/XMLSchema#unsignedByte"==a.datatype||"http://www.w3.org/2001/XMLSchema#positiveInteger"==a.datatype)return parseFloat(a.valueOf());
if("http://www.w3.org/2001/XMLSchema#boolean"===a.type)return"true"===a.valueOf()||!0===a.valueOf()||"True"===a.valueOf();if("http://www.w3.org/2001/XMLSchema#string"===a.type)return a.valueOf();if("http://www.w3.org/2001/XMLSchema#dateTime"===a.type)return new Date(a.valueOf());if(null==a.type)return a.valueOf()}else return a.valueOf()};sko.defaultLanguage=ko.observable(null);
sko.Resource=function(a,c,d){this.resourceId=a;this.valuesMap={};this.subscriptions=[];this.literalLangs={};this.classes={};var b=this;this.defaultLanguage=ko.dependentObservable(function(){return sko.defaultLanguage()});c=sko.NTUri(c);d.forEach(function(a){sko.log(a);"<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>"===a.predicate.toNT()&&(sko.log(" found resource class "+a.object.toNT()),b.classes[a.object.toNT()]=!0);if("NamedNode"===a.object.interfaceName)b.valuesMap[a.predicate.toNT()]=a.object.toNT(),
b[a.predicate.toNT()]=ko.observable(a.object.toNT());else if("Literal"===a.object.interfaceName)if(null!=b.defaultLanguage()){if(null==b.valuesMap[a.predicate.toNT()]||a.object.language==b.defaultLanguage()){var d=sko.effectiveValue(a.object.valueOf());b.valuesMap[a.predicate.toNT()]=d;b[a.predicate.toNT()]=ko.observable(d);b[sko.plainUri(a.predicate.toNT())]=b[a.predicate.toNT()];b.literalLangs[a.predicate.toNT()]=a.object.language}}else{if(null==b.valuesMap[a.predicate.toNT()]||null==a.object.language)d=
sko.effectiveValue(a.object.valueOf()),b.valuesMap[a.predicate.toNT()]=d,b[a.predicate.toNT()]=ko.observable(d),b[sko.plainUri(a.predicate.toNT())]=b[a.predicate.toNT()],b.literalLangs[a.predicate.toNT()]=a.object.language}else b.valuesMap[a.predicate.toNT()]=a.object.valueOf(),b[a.predicate.toNT()]=ko.observable(a.object.valueOf()),b[sko.plainUri(a.predicate.toNT())]=b[a.predicate.toNT()]});this.about=ko.observable(c);this["@"]=this.about;this.storeObserverFn=sko.Resource.storeObserver(this);sko.Class.check(this,
!0);b=this;this.subscriptions.push(this.about.subscribe(function(a){sko.log("SKO Resource new resource:"+a);sko.log("*** STOP OBSERVING NODE STORE");sko.store.stopObservingNode(b.storeObserverFn);if(null!=a&&0!=a.indexOf("_:sko"))sko.log("*** START OBSERVING NODE STORE FOR "+b.about()),sko.store.startObservingNode(sko.plainUri(a),b.storeObserverFn);else{sko.log("*** nullifying resources");for(var d in b.valuesMap)b.valuesMap[d]=null;for(d in b.valuesMap)b[d](null)}}));sko.Resource.koObserver(this);
sko.store.startObservingNode(sko.plainUri(this.about()),b.storeObserverFn)};sko.NTUri=function(a){if("["===a[0]&&"]"===a[a.length-1]){a=a.slice(1,a.length-1);resolved=sko.rdf.prefixes.resolve(a);if(null==a)throw"The CURIE "+a+" cannot be resolved";a="<"+resolved+">"}return a};sko.Resource.prototype.tryProperty=function(a){a=sko.NTUri(a);if(null==this[a]){this.valuesMap[a]=null;this[a]=ko.observable(null);var c=this;this.subscriptions.push(this[a].subscribe(function(d){c.notifyPropertyChange(a,d)}))}return this[a]};
sko.Resource.prototype.prop=function(a){return this.tryProperty(a)};sko.Resource.prototype.getProp=function(a){return this.tryProperty(a)()};sko.Resource.prototype.setProp=function(a,c){return this.tryProperty(a)(c)};
sko.Resource.prototype.notifyPropertyChange=function(a,c){sko.log("*** received KO notification for property "+a+" -> "+c);if(null==this.valuesMap[a])this.valuesMap[a]=c,0===this.about().indexOf("_:sko")||null!=c&&(0===c.indexOf("http")?sko.store.execute("INSERT DATA { "+this.about()+" "+a+" <"+c+"> }",function(){}):0===c.indexOf("<")?sko.store.execute("INSERT DATA { "+this.about()+" "+a+" "+c+" }",function(){}):sko.store.execute("INSERT DATA { "+this.about()+" "+a+' "'+c+'" }',function(){}));else if(this.valuesMap[a]!==
c&&!sko.isSKOBlankNode(c)){var d='"'+this.valuesMap[a]+'"',c='"'+c+'"';null!=this.literalLangs[a]&&(d=d+"@"+this.literalLangs[a],c=c+"@"+this.literalLangs[a]);var b="DELETE { "+this.about()+" "+a+" "+d+" }",b=b+" INSERT { "+this.about()+" "+a+" "+c+" }",b=b+" WHERE { "+this.about()+" "+a+" "+d+" }",b=b.replace(/"</g,"<").replace(/>"/g,">");this.valuesMap[a]=c;sko.log("*** updating STORE: \n  "+b);sko.store.execute(b)}};sko.isSKOBlankNode=function(a){return 0===a.indexOf("_:sko")};
sko.Resource.prototype.disconnect=function(){sko.log(" ** DISCONNECTING");sko.store.stopObservingNode(this.storeObserverFn);sko.log(" ** disconnected STORE");for(var a=0;a<this.subscriptions.length;a++)sko.log(" ** disconnecting subscription"),this.subscriptions[a].dispose();sko.log(" ** disconnecting resource map");sko.aboutResourceSubscriptionMap[this.resourceId].dispose();sko.log(" ** deleting");delete sko.aboutResourceMap[this.resourceId];delete sko.about[this.resourceId]};
sko.cleanNode=function(a){sko.log("*** CLEANING!");sko.log(a);var c=jQuery(a).attr("aboutId"),d=[];null!=c&&d.push(c);d=d.concat(sko.childrenResourceIds(a));for(a=0;a<d.length;a++)null!=sko.aboutResourceMap[d[a]]&&(sko.log("*** DISCONNECTING "+d[a]),sko.log(sko.aboutResourceMap[d[a]]),sko.aboutResourceMap[d[a]].disconnect())};
sko.Resource.koObserver=function(a){var c=function(a,d){sko.log("*** subcribing to property "+d);var c=a[d].subscribe(function(c){a.notifyPropertyChange(d,c)});a.subscriptions.push(c)},d;for(d in a.valuesMap)c(a,d)};
sko.Resource.storeObserver=function(a){return function(c){sko.log("*** received notification change from STORE in resource "+a.about());if(0!==a.about().indexOf("_:sko")){var d={},b={};sko.log("*** triples in STORE resource -> "+c.toArray().length);c.forEach(function(c){if("NamedNode"===c.object.interfaceName)sko.log(" "+c.predicate.toNT()+" -> "+c.object.toNT()),null!=d[c.predicate.toNT()]?d[c.predicate.toNT()].constructor===Array?(d[c.predicate.toNT()].push(c.object.toNT()),d[c.predicate.toNT()].sort()):
d[c.predicate.toNT()]=[d[c.predicate.toNT()],c.object.toNT()]:d[c.predicate.toNT()]=c.object.toNT();else if(null!=a.defaultLanguage()){if(null==d[c.predicate.toNT()]||c.object.language==a.defaultLanguage())null!=d[c.predicate.toNT()]?d[c.predicate.toNT()].constructor===Array?(d[c.predicate.toNT()].push(c.object.valueOf()),d[c.predicate.toNT()].sort()):b[c.predicate.toNT()]!=c.object.language?(d[c.predicate.toNT()]=c.object.valueOf(),b[c.predicate.toNT()]=c.object.language):d[c.predicate.toNT()]=[d[c.predicate.toNT()],
c.object.valueOf()]:(sko.log(" "+c.predicate.toNT()+" -> "+c.object.valueOf()),d[c.predicate.toNT()]=c.object.valueOf(),b[c.predicate.toNT()]=c.object.language)}else if(null==d[c.predicate.toNT()]||null==c.object.language)null!=d[c.predicate.toNT()]?d[c.predicate.toNT()].constructor===Array?(d[c.predicate.toNT()].push(c.object.valueOf()),d[c.predicate.toNT()].sort()):null!=b[c.predicate.toNT()]?(d[c.predicate.toNT()]=c.object.valueOf(),b[c.predicate.toNT()]=c.object.language):d[c.predicate.toNT()]=
[d[c.predicate.toNT()],c.object.valueOf()]:(sko.log(" "+c.predicate.toNT()+" -> "+c.object.valueOf()),d[c.predicate.toNT()]=c.object.valueOf(),b[c.predicate.toNT()]=c.object.language)});var e={},c=[],f=[],h=[],i;for(i in a.valuesMap)if(null!=d[i])if(e[i]=d[i],a.valuesMap[i]&&a.valuesMap[i].constructor===Array&&newValue[i].constructor===Array)a.valuesMap[i].length!=newValue[i].length&&f.push(i);else{if(a.valuesMap[i]!==d[i]&&(f.push(i),null!=b[i]||null!=a.literalLangs[i]))a.literalLangs[i]=b[i]}else c.push(i),
delete a.literalLangs[i];for(i in d)null==a.valuesMap[i]&&(h.push(i),e[i]=d[i],a.literalLangs[i]=b[i]);a.valuesMap=e;for(i=0;i<c.length;i++)sko.log("*** setting value to null "+c[i]+" -> NULL"),a[c[i]](null);for(i=0;i<f.length;i++)sko.log("*** updating value "+f[i]+" -> "+a.valuesMap[f[i]]),a[f[i]](a.valuesMap[f[i]]);for(i=0;i<h.length;i++)sko.log("*** new value "+h[i]+" -> "+a.valuesMap[h[i]]),a[h[i]]=ko.observable(a.valuesMap[h[i]]),a[sko.plainUri(h[i])]=a[h[i]];sko.Class.check(a);sko.log("*** END MODIFICATION")}}};
sko.traceResources=function(a,c,d){sko.log("** TRACING:");sko.log(a);var b=[];(jQuery(a).attr("about")||jQuery(a).attr("data-bind"))&&b.push(a);var a=jQuery(a).find("*[about], *[data-bind]").toArray(),b=b.concat(a),e=function(a,d){var i=b[d._i],g=jQuery(i).attr("about");if(null==jQuery(i).attr("aboutId")){if(null==g){var j=jQuery(i).attr("data-bind");null!=j&&-1!=j.indexOf("about:")&&(g=/s*([^ ]+)s*,?/.exec(j.split("about:")[1])[0],","===g[g.length-1]&&(g=g.slice(0,g.length-1)))}null!=g&&""!=g?("string"===
typeof g&&"<"!==g[0]&&">"!==g[g.length-1]&&"["!==g[0]&&"]"!==g[g.length-1]&&(g=c[g]),sko.about(g,c,function(b){jQuery(i).attr("aboutId",b);a(e,d)})):a(e,d)}else a(e,d)};Utils.repeat(0,b.length,e,function(){d()})};
sko.currentResource=function(a){sko.log("in current resource");sko.log(a);if(null==a)return sko.log("!!! top of DOM tree, About node not found"),null;var c=jQuery(a).attr("aboutId");sko.log("about id:"+c);if(c){a=sko.about[c]();sko.log("uri:"+a);if(null!=a)return sko.aboutResourceMap[c];sko.log("!!! current resource is null: "+c)}else return sko.log("recurring"),sko.currentResource(jQuery(a).parent().toArray()[0])};
sko.currentResourceNode=function(a){sko.log("in current resource node");sko.log(a);if(null==a)return sko.log("!!! top of DOM tree, About node not found"),null;var c=jQuery(a).attr("aboutId");sko.log("about id:"+c);if(c){var d=sko.about[c]();sko.log("uri:"+d);if(null!=d)return a;sko.log("!!! current resource is null: "+c);return null}sko.log("recurring");return sko.currentResourceNode(jQuery(a).parent().toArray()[0])};sko.childrenResourceIds=function(a){return jQuery(a).find("*[aboutId]").map(function(){return jQuery(this).attr("aboutId")})};
sko.traceRelations=function(a,c,d){sko.log("*** TRACING RELATIONS:");a=sko.currentResourceNode(a)||a;sko.log("*** FOUND ROOT NODE TO LOOK FOR RELATIONS:");sko.log(a);var b=[];(jQuery(a).attr("rel")||jQuery(a).attr("data-bind"))&&b.push(a);a=jQuery(a).find("*[rel], *[data-bind]").toArray();b=b.concat(a);sko.log(" ** NODES TO LOOK FOR RELATED RESOURCES");sko.log(b);var e=function(a,d){var i=b[d._i],g=jQuery(i).attr("rel");if(null==g){var j=jQuery(i).attr("data-bind");null!=j&&-1!=j.indexOf("rel:")&&
(g=/s*([^ ]+)s*,?/.exec(j.split("rel:")[1])[0],","===g[g.length-1]&&(g=g.slice(0,g.length-1)))}null!=g&&""!=g?("string"===typeof g&&"<"!==g[0]&&">"!==g[g.length-1]&&"["!==g[0]&&"]"!==g[g.length-1]&&(g=c[g]),null==jQuery(i).attr("aboutId")?(sko.log("*** CREATING RELATED NODE"),sko.rel(g,i,c,function(b){jQuery(i).attr("aboutId",b);a(e,d)})):(sko.log("*** NODE IS ALREADY TRACED"),a(e,d))):a(e,d)};Utils.repeat(0,b.length,e,function(){d()})};sko.generatorId=0;sko.generatorsMap={};
sko.where=function(a){var a="select ?subject where "+a,c=""+sko.generatorId;sko.generatorId++;sko.generatorsMap[c]=ko.observable([]);sko.log("*** WHERE QUERY: "+a);sko.store.startObservingQuery(a,function(a){var b=[];sko.log(" ** RESULTS!!!");for(var e=0;e<a.length;e++)sko.log(" ** ADDING VALUE "+a[e].subject.value),b.push("<"+a[e].subject.value+">");sko.log("** SETTING VALUE");sko.log(b);sko.generatorsMap[c](b)});return sko.generatorsMap[c]};
sko.applyBindings=function(a,c,d){"string"===typeof a&&(a=jQuery(a)[0]);sko.traceResources(a,c,function(){sko.traceRelations(a,c,function(){ko.applyBindings(c,a);null!=d&&d()})})};sko.resource=function(a){a=jQuery(a).toArray();if(1===a.length)return sko.currentResource(a[0]);for(var c=[],d=0;d<a.length;d++)c.push(sko.currentResource(a[d]));return c};sko.owl={};
})(window);
